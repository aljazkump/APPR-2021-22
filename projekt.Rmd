---
title: "Analiza odseljevanja iz Slovenije"
author: "Aljaž Kump"
output:
  html_document: default
  pdf_document:
    includes:
      in_header: lib/styles.sty
    latex_engine: xelatex
runtime: shiny
---

```{r setup, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE)

# Uvoz vseh potrebnih knjižnic
source("lib/libraries.r", encoding="UTF-8")
```

```{r rstudio, results='asis'}
# Izris povezave do RStudia na Binderju
source("lib/rstudio.r", encoding="UTF-8")
```

<font size = "4">
Za projektno nalogo sem si izbral, da bom analiziral odseljevanje prebivalcev RS
glede na leto, spol, starost, delovno aktivnost, izobrazbo in 
državo prihodnjega prebivališča. Podatke sem dobil iz SI-STAT-a in Eurostat-a.
</font>

</br>

# Obdelava, uvoz in čiščenje podatkov

```{r uvoz, echo=FALSE, message=FALSE, warning=FALSE, results='hide'}
source("uvoz/uvoz.r", encoding="UTF-8")
```

<font size = "4">
Podatke o odseljevanju sem uvozil v obliki CSV in XML formata. Delijo se na tri dele.
Prvi zajema splošne podatke o odseljevanju iz Slovenije. Drugi ima podatke o
odseljevanju glede na prihodnjo prebivališče. Vsi podatki so od leta 2011 do 2020.

1. `Starost_Izobrazba_Spol` - zajema kombinacije štirih spremenljivk,
  - `starost` - mladi, zreli, stari(neurejen faktor),
  - `spol` -  moški, ženski(neurejen faktor),
  - `izobrazba` - stopnja izobrazbe(neurejen faktor),
  - `leto` - število

2. `Starost_Spol` - zajema kombinacije treh spremenljivk,
  - `starost` - mladi, zreli, stari(neurejen faktor),
  - `spol` -  moški, ženski(neurejen faktor),
  - `leto` - število
  
3. `Aktivnost` - zajema kombinacije stirih spremenljivk,
  - `delovna aktivnost` - zaposlen, nezaposlen(neurejen faktor),
  - `starost` - mladi, zreli, stari(neurejen faktor),
  - `spol` -  moški, ženski(neurejen faktor),
  - `leto` - število

4. `Starost_Evropa` - zajema kombinacije treh spremenljivk,
  - `evropske drzave` - neurejen faktor,
  - `starost` - mladi, zreli(neurejen faktor),
  - `leto` - število
  
5. `Evropa` - zajema kombinacije dveh spremenljivk,
  - `evropske drzave` - neurejen faktor,
  - `leto` - število
  </font>

</br>
  
# Vizualizacija podatkov

```{r vizualizacija, echo=FALSE, message=FALSE, warning=FALSE,  results='hide'}
source("vizualizacija/vizualizacija.r", encoding="UTF-8")
```

## Splošna slovenska statistika

</br>

### Odseljevanje moškega prebivalstva po starosti

```{r hist1, fig.align='left', out.width="70%", out.height="30%"}
print(Izseljevanje_Moski_Starost_Graf)
```

<font size = "4">
Zgornji histogram prikazuje kako se je skozi leto spreminjal delez starostne sestave odseljenega moškega prebivalstva. Največ je bilo zrelega prebivalstva, potem mladega in nato starega. Skozi leta so deleži ostali podobni.
</font>

</br>

### Odseljevanje ženskega prebivalstva po starosti

```{r hist2, fig.align='left', out.width="70%", out.height="30%"}
print(Izseljevanje_Zenske_Starost_Graf)
```

<font size = "4">
Pri ženskem spolu je na bilo na začetku desetletja(2011 in 2012) največ zrelih, nato
pa so se deleži spremenili. Od leta 2014 do 2020 je najvecji delež predstavljalo mlado
prebivalstvo. Delež starejših je tako kot pri moških najmanjši.
</font>

</br>

### Odseljevanje mladega in zrelega prebivalstva

```{r hist3, fig.align='left', out.width="70%", out.height="30%"}
print(Izseljevanje_Mladi_Zreli_Graf)
```

<font size = "4">
Ta histogram na splošno prikazuje, kar sta prikazovala zgornja dva histograma, le da v tem primeru ločujemo na spol in na starost. Ne prikazujemo vec deleže ampak dejanske številke. Skozi celotno desetletje se je izselilo vec moskih kot zensk. Razmerje se je v zadnjih treh letih(2018 - 2020) še bolj povečalo kljub lockdownu. Med moškimi se je vedno izselilo več zrelih kot mladih. Pri ženskah je ravno obratno. Razen leta 2011, se je vedno izselilo več mladih. Najvec zenskega prebivalstva se je izselilo leta 2017, najvec moškega pa leta 2020.
</font>

</br>

### Odseljevanje mladega prebivalstva glede na spol

```{r graf2, figures-side, fig.show="hold", out.width="50%"}
print(Izseljevanje_Mladi_Moski_Graf)
print(Izseljevanje_Mlade_Zenske_Graf)
```

<font size = "4">
Grafa prikazujeta, kako se mlado prebivalstvo razlikuje po izobrazbeni sestavi glede na spol. Prikazan je s deleži.

Pri moških prevladuje skozi vsa leta srednješolska izobrazba. Na začetku desetletja je bil delež odseljenih z osnovnošolsko izobrazbo večji od višješolskega. Potem se je delež drugega povečal in je od leta 2014 do danes še vedno večji.

Pri ženskam je drugače. Odseljenih z osnovnošolsko izobrazbo je daleč najmanj. Na začetku se jih je največ izselilo s srednješolsko, nato pa se je kar precej povečal delež odseljenih žensk z visokošolsko izobrazbo.
</font>

</br>

### Odseljevanje zrelega prebivalstva glede na spol

```{r graf3, figures-side, fig.show="hold", out.width="50%"}
print(Izseljevanje_Zreli_Moski_Graf)
print(Izseljevanje_Zrele_Zenske_Graf)
```

<font size = "4">

Pri moških je graf podoben kot pri mladih. Vidno največji delež ima srednješolsko.
Skozi vseh desetih let je bil daleč največji. Odseljenih z osnovnošolsko je vse manj, narašča pa delež z visokošolsko.

Pri ženskah tudi ni večje razlike. Največ je visokoizobraženih, ki jih je vsako leto več, saj druga dva deleža upadata. Za konec lahko rečemo, da to potrjuje, da izobrazba bolj vpliva na odseljevanje kot starost.
</font>

</br>

### Odseljevanje prebivalstva glede na izobrazbo

</br>

```{r graf4, figures-side, fig.show="hold", out.width="50%"}
print(VS_Graf)
print(SS_Graf)
```

```{r graf5, fig.align='center',out.width="50%"}
print(OS_Graf)
```

<font size = "4">
Kot smo omenili pri prejšnih grafih je, da na odseljevanje najbolj vpliva izobrazba, zato smo pri slednjih grafih prikazali deleže vseh kombinacij spola in starosti glede na izobrazbo. Podatki so iz leta 2011 in 2020. Zanima nas sprememba v zadnjem desetletju.

Pri visokošolski izobrazbi je pri obeh letih prevladovala mlado in zrelo žensko prebivalstvo. Imeli sta tudi veliko spremembo. Povečalo se je skoraj za dvakrat. Največjo je imelo mlado moško prebivalstvo od 124 na 276. 

Pri srednješolski izobrazbi so bile najmanše spremembe. Največ je bilo v obeh letih zrelega moškega prebivalstva. Največjo pozitivno spremembo je imelo mlado prebivalstvo. Edina kategorija z negativno spremembo je imelo zrelo žensko prebivalstvo.

Pri osnovnošolski izobrazbi je zrelo prebivalstvo doživelo največji upad za okoli 50%. Edini kategoriji, ki sta narastli sta mlada moška in ženska populacija. Leta 2011 je bilo največ zrelih moških, leta 2020 pa mladih moških.


</font>

</br>

### Odseljevanje aktivnega in neaktivnega prebivalstva

</br>

```{r graf6, figures-side, fig.show="hold", out.width="50%"}
print(Aktivni_Graf)
print(Neaktivni_Graf)
```

<font size = "4">
Zgornja grafa prikazujeta število aktivnega(zaposlenega) in neaktivnega(nezaposlenega) prebivalstvo glede na spol. Skozi vsa leta, se je izselilo več delovno aktivnih kot delovno neaktivnih, ne glede na vsako kombinacijo starosti in spola. 

Med aktivnimi je bilo skozi vsa leta največ zrelega moškega prebivalstva. Nato je sledilo mlado prebivalstvo. Najmanj je bilo zrelih žensk. Nobena kategorija nima svojega trenda. Pri vseh je krivulja enake oblike. Na začetku desetletja so vse naraščale na koncu pa vse padajo.

Pri neaktivnih je graf podoben. Največ je zrelih moških, nato pa so vse ostale kategorije dokaj enake. Trend je tukaj nekolika drugačen. Vse skupine so rastle do leta 2017, nato pa so doživele padec in padajo do danes.
</font>

</br>

## Evropska statistika

</br>

### Vizualizacija odseljevanja v evropske drzave

```{r map1, out.width="75%", out.height="50%", fig.align='left'}
print(Evropa_map)
```

<font size = "4">
Na zemljevidu je z prikazano skupno število odseljenih v zadnjem desetletju. Rdeče so najbolj poseljene države, rumene pa najmanj. Nekaj držav izstopa. To so Avstrija, Nemčija, Italija, Švica, Velika Britanija in Hrvaška. Edina država v katero se ni noben izselil je Moldavija. Drugače pa je evropska porazdelitev izseljenih enakomerna.
</font>

## Odseljevanje v najbolj priseljene drzave glede na starost

</br>

```{r graf7, out.width="100%"}
print(Drzave_Graf);
```

<font size = "4">
Za konec evropske statistike bomo predtsavili bolj podrobno države, v katere se je izselilo največ Slovencev.

Države, ki so bolj razvite imajo več mladega prisljenega prebivalstva. Te so švica, Avstrija in Velika Britanija ter Nemčija. Državi kot sta Hrvaška in Italija, ki sta manj raziti kot zgornje pa imata veliko več priseljenih zrele starost. Najbolj razgibana grafa imata Avstrija in Nemčija, ki se gibata z trendom. Pri ostalih državah pa so krivulje bolj enakomerne in se niso nekaj dosti spreminjale. Pri vseh je bil višek odseljenih leta 2017.
</font>

</br>

# Napredna analiza podatkov

```{r analiza, echo=FALSE, message=FALSE, warning=FALSE,  results='hide'}
source("analiza/analiza.r", encoding="UTF-8")
```

</br>

<font size = "4">
Pri napredni analizi bom analiziral vsak spol posebej. Najprej bom oblikoval dendogram in grupiral točke, nato pa bom z linearno regresijo napovedal trend. Izbral sem si tisto regresijo, katere "medium residuals" so blizu 0. Trend regresije pa bom potrdil z "moving average" krivuljo.
</font>

## Analiza moškega prebivalstva

</br>

<font size = "4">
Pri moškemu prebivalstvu bom analiziral populacijo s srednješolsko izobrazbo, saj ima največji delež. Z fukcijo cutree sem razdelil podatke na 3 skupine.
</font>

```{r dendogram1, fig.align='left', out.width="70%", out.height="30%"}
print(dendogram1);
```

</br>

```{r razvrstitev1,  fig.align='left', out.width="70%", out.height="30%"}
print(razvrstitev1);
```

</br>

<font size = "4">
Za napoved sem si izbral kvadratno linearno regresijo, ki je na grafu modra krivulja. Rdeča predstavlja "moving average" dolžine 3. Uporabil sem samo podatke mladega in zrelega prebivalstva, saj najbolj oblikujeta trende. Vidno je, da je med letoma 2016 in 2017 odseljevanje doživelo maksimum in je po tem začelo padati.
</font>

```{r napoved1,  fig.align='left', out.width="70%", out.height="30%"}
print(napoved1);
```

</br>

## Analiza ženskega prebivalstva

</br>

<font size = "4">
Pri ženskemu prebivalstvu bom analiziral populacijo s višješolsko izobrazbo, saj ima največji delež. Z fukcijo cutree sem razdelil podatke na 3 skupine.
</font>

### Dendogram ženskega prebivalstva

```{r dendogram2, fig.align='left', out.width="70%", out.height="30%"}
print(dendogram2);
```

</br>

### Razvrščanje ženskega prebivalstva

```{r razvrstitev2,  fig.align='left', out.width="70%", out.height="30%"}
print(razvrstitev2);
```

</br>

<font size = "4">
Podobno kot pri moškem prebivalstvu sem naredil tudi za žensko populacijo. Krivulji sta si zelo podobi. Isto leto imata maksimum(2016 in 2017) in potem začneta padati. Le da pri ženskah je krivulja malo bolj položna.
</font>

```{r napoved2,  fig.align='left', out.width="70%", out.height="30%"}
print(napoved2);
```

</br>

# Zaključek

</br>

<font size = "4">

* Več se izseljuje moškega kot ženskega prebivalstva
* Višek odseljevanja je bil med letoma 2016 in 2017
* Pri moških najbolj prevladuje srednješolska izobrazba in zrela starostna skupina
* Pri ženskah najbolj prevladuje visokošolska izobrazba in mlada starostna skupina
* Na trend odseljevanja bolj vpliva izobrazba kot starost
* Odseljevanje ljudi z visokošolsko izobrazbo je doživelo največjo pozitivno rast, največ se odseli mladih
* Odseljevanje ljudi s srednješolsko izobrazbo ni imelo večje spremembe, še vedno se največ se odseli zrelih moških
* Odseljevanje ljudi z osnovnošolsko izobrazbo je doživelo največjo negativno rast
* Več se odseli delovno aktivnega kot neaktivnega prebivalstva
* Največ ljudi se odseli v Nemčijo in Avstrijo

</font>


