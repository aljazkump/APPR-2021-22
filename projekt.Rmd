---
title: "Analiza odseljevanja iz Slovenije"
author: "Aljaž Kump"
output:
  html_document: default
  pdf_document:
    includes:
      in_header: lib/styles.sty
    latex_engine: xelatex
runtime: shiny
---

```{r setup, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE)

# Uvoz vseh potrebnih knjižnic
source("lib/libraries.r", encoding="UTF-8")
```

```{r rstudio, results='asis'}
# Izris povezave do RStudia na Binderju
source("lib/rstudio.r", encoding="UTF-8")
```

<font size = "4">
Za projektno nalogo sem si izbral, da bom analiziral odseljevanje prebivalcev RS
glede na leto, spol, starost, delovno aktivnost, izobrazbo in 
državo prihodnjega prebivališča. Podatke sem dobil iz SI-STAT-a in Eurostat-a.
</font>

</br>

# Obdelava, uvoz in čiščenje podatkov

```{r uvoz, echo=FALSE, message=FALSE, warning=FALSE, results='hide'}
source("uvoz/uvoz.r", encoding="UTF-8")
```

<font size = "4">
Podatke o odseljevanju sem uvozil v obliki CSV formata. Delijo se na tri dele.
Prvi zajema splošne podatke o odseljevanju iz Slovenije. Drugi ima podatke o
odseljevanju glede na prihodnjo prebivališče. Vsi podatki so od leta 2011 do 2020.

1. `starost_izobrazba_spol` - zajema kombinacije štirih spremenljivk,
  - `starost` - spremenljivka: mladi, zreli, stari(neurejen faktor),
  - `spol` - spremenljivka: moški, ženski(neurejen faktor),
  - `izobrazba` - spremenljivka: stopnja izobrazbe(neurejen faktor),
  - `leto` - spremenljivka(število)

2. `Starost_spol` - zajema kombinacije treh spremenljivk,
  - `starost` - spremenljivka: mladi, zreli, stari(neurejen faktor),
  - `spol` - spremenljivka: moški, ženski(neurejen faktor),
  - `leto` - spremenljivka(število)
  
3. `aktivnost` - zajema kombinacije stirih spremenljivk,
  - `delovna aktivnost` - spremenljivka: zaposlen, nezaposlen(neurejen faktor),
  - `spol` - spremenljivka: moški, ženski(neurejen faktor),
  - `starost` - premenljivka: mladi, zreli(neurejen faktor),
  - `leto` - spremenljivka(število)

4. `starost_Evropa` - zajema kombinacije treh spremenljivk,
  - `evropske drzave` - spremenljivka(neurejen faktor),
  - `starost` - premenljivka: mladi, zreli(neurejen faktor),
  - `leto` - spremenljivka(število)
  
5. `izobrazba_Evropa` - zajema kombinacije treh spremenljivk,
  - `evropske drzave` - spremenljivka(neurejen faktor),
  - `izobrazba` - spremenljivka: stopnja izobrazbe(neurejen faktor),
  - `leto` - spremenljivka(število)
  
6. `Evropa` - zajema kombinacije dveh spremenljivk,
  - `evropske drzave` - spremenljivka(neurejen faktor),
  - `leto` - spremenljivka(število)
  
7. `obcine_odseljeni` - zajema kombinacije dveh spremenljivk,
  - `obcine` - spremenljivka(neurejen faktor),
  - `leto` - spremenljivka(število)
  
</font>

</br>
  
# Vizualizacija podatkov

```{r vizualizacija, echo=FALSE, message=FALSE, warning=FALSE,  results='hide'}
source("vizualizacija/vizualizacija.r", encoding="UTF-8")
```

<font size = "4">
V tem delu bom predstavil podatke v obliki grafov, histogramov, in zemljevidov. Pri bolj splošnih spremenljivkah bom predstavil tudi napoved do leta 2023 y linearno ali kvadratno regresijo. Za napoved take teme kot je odseljevanje je velika moznost da napovedi ne bodo najbolj točne saj na to vpliva veliko spremenljivk, ki jih težko merimo oz. napovemo kot so gospodarsko okrevanje po krizi, inflacija, povprasevanje po delovni sili v tujini.
</font>

</br>

## Splošna slovenska statistika

</br>

### Odseljevanje moškega prebivalstva po starosti

```{r hist1, fig.align='left', out.width="70%", out.height="30%"}
print(Izseljevanje_Moski_Starost_Graf)
```

<font size = "4">
Zgornji histogram prikazuje kako se je skozi leto spreminjala starostna sestava odseljenega moskega prebivalstva. Največ je bilo zrelega prebivalstva, potem mladega in nato starega. Skozi leta so deleži ostali podobni.
</font>

</br>

### Odseljevanje ženskega prebivalstva po starosti

```{r hist2, fig.align='left', out.width="70%", out.height="30%"}
print(Izseljevanje_Zenske_Starost_Graf)
```

<font size = "4">
Pri ženskem spolu pa je drugače. Najvec je mladih, ki jih je več kot polovico in šele nato zrelih.  
</font>

</br>

### Odseljevanje mladega in zrelega prebivalstva

```{r hist3, fig.align='left', out.width="70%", out.height="30%"}
print(Izseljevanje_Mladi_Zreli_Graf)
```

<font size = "4">
Ta histogram na splošno prikazuje kar sta prikazovala zgornja histograma, le da v tem primeru ne ločujemo na spol ampak gledamo le razmerje mladi zreli. Skozi zadnje desetleje je bilo število mladih in zrelih bolj kot ne isto, vendar se vidi kako v zadnjih treh letih veliko hitreje narašča število mladega prebivalstva kot zrelega. Preseneča tudi podatek leta 2020. Kot kaze korona kriza in "lockdown" nista vplivala na trend.
</font>

</br>

### Odseljevanje mladega prebivalstva glede na spol

```{r graf2, figures-side, fig.show="hold", out.width="50%"}
print(Izseljevanje_Mladi_Moski_Graf)
print(Izseljevanje_Mlade_Zenske_Graf)
```

<font size = "4">
Grafa prikazujeta, kako se mlado prebivalstvo razlikuje po izobrazbeni sestavi glede na spol. 

Pri moških prevladuje skozi vsa leta srednješolska izobrazba. Osnovno in visješolska pa sta skozi desetletje približno enaki. Višja malo bolj prevladuje od osnovne zadnja leta. 

Pri ženskam je drugače. Odseljenih z osnovnošolsko izobrazbo skoraj ni. Tako kot pri levem grafu je veliko z srednješolsko vendar jih je prav toliko z visješolsko. Na podlagi grafov lahko recemo da je povprečna izobrazba mladih odseljenih žensk višja od moških.
</font>

</br>

### Odseljevanje zrelega prebivalstva glede na spol

```{r graf3, figures-side, fig.show="hold", out.width="50%"}
print(Izseljevanje_Zreli_Moski_Graf)
print(Izseljevanje_Zrele_Zenske_Graf)
```

<font size = "4">

Pri moških je graf podoben. Vidno največ s srednješolsko, ostali pa podobno. Pri ženskah tudi ni večje razlike, le da je dalj časa prevladovala srednjesolka izobrazba. Na podlagi spodnjih dveh grafov lahko trdimo, da izobrazba bolj vpliva na odseljevanje kot starost.
</font>

</br>

### Odseljevanje prebivalstva glede na izobrazbo

</br>

```{r graf4, figures-side, fig.show="hold", out.width="50%"}
print(VS_Graf)
print(SS_Graf)
```

```{r graf5, fig.align='center',out.width="50%"}
print(OS_Graf)
```

<font size = "4">
Kot smo omenili pri prejšnih grafih je, da na odseljevanje najbolj vpliva izobrazba, zato smo pri slednjih grafih prikazali deleže vseh kombinacij spola in starosti glede na izobrazbo. Podatke iz leta 2011 in 2020.

Pri visokošolski izobrazbi je pri obeh letih prevladovala mlado in zrelo žensko prebivalstvo. Imeli sta tudi največjo spremembo. Pri srednješolski je daleč največ zrelih moških. Največjo spremembo je imelo mlado prebivalstvo. Osnovnošolska je imela največji upad zrelih, najbolj pa se je povecal delez mladih, ki so na prvem in drugem mestu.


</font>

</br>

### Odseljevanje aktivnega in neaktivnega prebivalstva

</br>

```{r graf6, figures-side, fig.show="hold", out.width="50%"}
print(Aktivni_Graf)
print(Neaktivni_Graf)
```

<font size = "4">
Zgornja grafa prikazujeta aktivno(zaposleno) in neaktivno(nezaposleno) glede na spol. Med zaposlenimi se je izselilo največ žensk in mladih. Med nezaposlenimi pa je v zadnjih letih število vseh skupin podobno.
</font>

</br>

## Evropska statistika

</br>

### Vizualizacija odseljevanja v evropske drzave

```{r map1, out.width="75%", out.height="40%", fig.align='left'}
print(Evropa_map)
```

<font size = "4">
Na zemljevidu je z prikazano skupno število odseljenih v zadnjem desetletju. Rdeče so najbolj poseljene rumene pa najmanj. Nekaj držav izstopa. To so Avstrija, Nemčija, Italija, Švica, Velika Britanija in Hrvaška.
</font>

## Odseljevanje v najbolj priseljene drzave glede na starost

</br>

```{r graf7, out.width="100%"}
print(Drzave_Graf);
```

<font size = "4">
Države, ki so najbolj razvite imajo največ mladih prisljenih kot so švica, Avstrija in Velika Britanija ter Nemčija. Državi kot sta Hrvaška in Italija, ki sta manj raziti kot zgornje pa imata veliko več priseljenih zrele starost.
</font>

</br>

# Napredna analiza podatkov

```{r analiza, echo=FALSE, message=FALSE}
source("analiza/analiza.r", encoding="UTF-8")
```

<font size = "4">
Pri napredni analizi bom analiziral spremenljivki, ki sta se pokazali da sta najbolj pomemni s polinomsko analizo. Te sta izobrazba in starost.
</font>

</br>

### Analiza odseljevanja moškega prebivalstva

</br>

```{r graf8, figures-side, fig.show="hold", out.width="50%"}
print(Mladi_Moski_Napoved)
print(Zreli_Moski_Napoved)
```

<font size = "4">
Pri obeh starostnih skupinah je trend enak. Predvideno je da bodo številke izseljenih še naprej naraščale.
</font>

</br>

### Analiza odseljevanja ženskega prebivalstva

```{r graf9, figures-side, fig.show="hold", out.width="50%"}
print(Mlade_Zenske_Napoved)
print(Zrele_Zenske_Napoved)
```

</br>

<font size = "4">
Pri mladih je trend pozitiven, pri zrelih pa je predviden manjsi upad.
</font>

</br>

### Analiza odseljevanja prebivalstva glede na izobrazbo

```{r graf10, figures-side, fig.show="hold", out.width="50%"}
print(VS_Napoved)
print(SS_Napoved)
```

```{r graf11, fig.align='center',out.width="50%"}
print(OS_Napoved)
```

</br>

<font size = "4">
Napoved nam pove, da bo v prihodnostki vse večje povprasevanje po izobraženi delovni sili. Visokošolska bo imela veliko rast, srednješolka manjši upad, osnovnošolska pa kar velik.
</font>

</br>